# AIエージェントによるパワーポイント資料自動生成システム

このプロジェクトは、ユーザーが指定した内容に基づいてパワーポイントのプレゼンテーション資料を自動生成するAIエージェントを提供します。LangChainとLangGraphを活用した複数のLLMを接続したワークフローによって、高品質なプレゼンテーション資料を作成します。画像や動画の挿入にも対応しています。

## 機能

- ユーザーのテキスト入力からプレゼンテーションのストーリーを自動生成
- 生成されたストーリーの十分性や適切性を評価し、必要に応じて改善
- ストーリーに基づいたスライド内容の自動生成
- スライド内容をpython-pptxを使用したPythonコードに変換
- 画像や動画を含むリッチなプレゼンテーションの作成

## 必要条件

- Python 3.10以上
- 依存ライブラリ（requirements.txtに記載）

## インストール方法

```bash
# リポジトリをクローン
git clone <repository-url>
cd <repository-directory>

# 依存ライブラリのインストール
pip install -r requirements.txt
```

## 使用方法

### コマンドラインインターフェース

1. `/workspace/input` ディレクトリに `template.pptx` というパワーポイントテンプレートファイルを配置します。

2. プレゼンテーション内容を記述したテキストファイル（.txt, .docx, または .md）を用意します。
   
   サンプルとして `sample_input.txt` が含まれています。

3. 画像や動画を使用する場合は、`workspace/input/images` ディレクトリにファイルを配置します。

4. 以下のコマンドを実行して、プレゼンテーション生成コードを作成します。

```bash
python main.py --file sample_input.txt
```

5. 生成されたPythonコードは `/workspace/output/create_pptx.py` に保存されます。

6. 生成されたコードを実行して、パワーポイントファイルを作成します。

```bash
python /workspace/output/create_pptx.py
```

7. 出力されたパワーポイントファイルは `/workspace/output` ディレクトリに保存されます。

### Streamlitウェブインターフェース

より使いやすいウェブインターフェースを使用する場合は、Streamlitアプリケーションを実行します：

```bash
streamlit run app.py
```

ブラウザで次の操作が可能です：

1. テキストファイル（.txt, .docx, .md）のアップロード
2. テンプレートファイル（.pptx）のアップロード
3. 画像・動画ファイルのアップロード
4. OpenAI APIキーの入力
5. モデルの選択
6. プレゼンテーション生成の実行
7. 生成されたプレゼンテーションのダウンロード

## 画像・動画の使用方法

テキストファイル内で画像や動画を指定するには、以下のフォーマットを使用します：

```
[画像: 説明テキスト]
[動画: 説明テキスト]
```

AIは、これらの指示と説明に基づいて適切な画像や動画ファイルを選択し、プレゼンテーションに挿入します。

## ワークフロー

AIエージェントのワークフローは以下の通りです：

1. ユーザーの入力（プレゼン内容の説明テキスト）を受け取り、プレゼンのストーリーを作成
2. 作成したストーリーが十分か＆適切かを判定（OK: 3へ/NG: 1へ）
3. ストーリーをもとにプレゼンの内容を作成（画像・動画の指示を含む）
4. プレゼン内容をpptx化するPythonコードを生成（画像・動画の挿入処理を含む）

## ディレクトリ構造

```
.
├── datamodel.py            # データモデルの定義
├── story_generator.py      # ストーリー生成器
├── story_evaluator.py      # ストーリー評価器
├── slide_contents_generator.py  # スライド内容生成器
├── pptx_code_generator.py  # PPTXコード生成器
├── pptx_agent.py           # AIエージェント本体
├── main.py                 # コマンドライン用メインプログラム
├── app.py                  # Streamlitアプリケーション
├── requirements.txt        # 依存ライブラリ
├── README.md               # 使用方法の説明
├── sample_input.txt        # サンプル入力ファイル
└── workspace/              # 作業ディレクトリ
    ├── input/              # 入力ファイル（テンプレートなど）
    │   └── images/         # 画像・動画ファイル
    └── output/             # 出力ファイル（生成コード、PPTXなど）
```

## 注意事項

- テンプレートファイル（template.pptx）のレイアウト構造に依存しているため、異なるテンプレートを使用する場合は、pptx_code_generator.pyのプロンプトを適宜調整してください。
- 画像や動画を使用する場合は、必ず `workspace/input/images` ディレクトリにファイルを配置し、テキスト内で適切に指示してください。
- 最適な結果を得るためには、具体的で明確なプレゼンテーション内容を記述することをおすすめします。

## ライセンス

[ライセンス情報]
